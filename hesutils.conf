
# HESIOD UTILITIES CONFIGURATION FILE
# ===================================
#
# Refer to the Hesutils documentation for further information.
#
# ==============================================================================
#
# This file is part of Hesutils <https://gitlab.com/jflf/hesutils>
# Hesutils Copyright (c) 2019-2021 JFLF
#
# Hesutils is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# Hesutils is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with Hesutils. If not, see <https://www.gnu.org/licenses/>.
#
# ==============================================================================



# Hesiod namespace configuration
# ------------------------------------------------------------------------------

# Left-hand side and right-hand side domain components used in Hesiod lookups.
#
# - LHS can be empty, RHS must be defined.
# - Neither can contain spaces or non-printable characters (they must be
#   lexically valid domain components).
# - For compatibility reasons both must include a leading dot.
# - /etc/hesiod.conf on the client machines must contain the same LHS and RHS.
#
# Note that the top-level component (the rightmost part of the RHS, after the
# last dot) must NOT be ".local", as this is the domain component used for mDNS
# queries (Bonjour, Avahi, etc).
#
# As a configuration example, this is the configuration needed to query the
# original Hesiod name server from the Athena project at MIT:
#   LHS=.ns
#   RHS=.athena.mit.edu
#
# Default values:       LHS=
#                       RHS=.hesiod
#
# The default values work well for a local system without a domain.
#
LHS=
RHS=.hesiod



# User and group configuration
# ------------------------------------------------------------------------------

# Minimum and maximum UID values for Hesiod user accounts?
#
# Default values:       UIDMIN=5000
#                       UIDMAX=5999
#
UIDMIN=5000
UIDMAX=5999

# Minimum and maximum GID values for Hesiod groups?
#
# Default values:       GIDMIN=${UIDMIN}
#                       GIDMAX=${UIDMAX}
#
GIDMIN=${UIDMIN}
GIDMAX=${UIDMAX}



# Generated records
# ------------------------------------------------------------------------------

# Trim the passwd GECOS field?
#
# Trimming the GECOS fields (not exporting them through Hesiod) makes the user
# and uid records a bit shorter.
#
# Default value:        TRIMGECOS=1
#
TRIMGECOS=1

# Include the full member list in group and gid records?
#
# Including the full user list (of Hesiod users only) in the group records makes
# getent group on the clients behave like on a local machine, returning the full
# list of members of that group. That may be required by some applications.
#
# Depending on the number of members, those lists can grow to very large sizes,
# requiring multiple TXT strings and potentially reaching the maximum size of a
# DNS answer (65535 bytes). Therefore it's only practical on sites where no
# group contains a very large number of users.
#
# Default value:        FULLMEMBERLIST=0
#
FULLMEMBERLIST=0



# Home directory transformation mechanisms
# ------------------------------------------------------------------------------

# NOTE: The entire topic of home directories and FILSYS records is complex!
#       Please see the Hesutils documentation for details and examples.


# Mechanism #1: sed commands

# Expressions passed as parameter to sed to modify the home directories.
# Leave empty or commented out to skip those step.
#
# HOMESEDEXPORT transforms the passwd path into the export path.
# HOMESEDMOUNT transforms the passwd path into the mount path.
#
# HOMESEDEXPORT is only used for FILSYS records.
#
# Examples:
# Passwd path:          /home/myuser
# Export path:          /export/home/myuser
# Mount path:           /mnt/nfs/home/myuser
# HOMESEDEXPORT:        's:^:/export:'
# HOMESEDMOUNT:         's:^:/mnt/nfs:'
#
# Default values:       HOMESEDEXPORT=  [empty]
#                       HOMESEDMOUNT=  [empty]
#
HOMESEDEXPORT=
HOMESEDMOUNT=

# Mechanism #2: map file

# Map file containing per-user static homedir and FILSYS entries.
# Leave empty or commented out to skip that step.
#
# Syntax for passwd records only, whitespace-separated:
# <user name>|*  <home path>
#
# Syntax for FILSYS records, whitespace-separated:
# <user name>|*  AFS  <export path>  <mount options>  <mount path>
# <user name>|*  NFS  <export path>  <server>  <mount options>  <mount path>
# <user name>|*  <FS type>  <device>  <mount options>  <mount path>
#
# Empty lines and comments (#) are ignored.
#
# Default value:        FSMAPFILE=  [none]
#
FSMAPFILE=

# Mechanism #3: custom command

# Command to run to obtain per-user homedir and FILSYS entries.
# Leave empty or commented out to skip that step.
#
# Parameters passed to the command: all the individual fields of the passwd
# entry, in the same order as in the passwd entry.
#
# Output on stdout for passwd records only, whitespace-separated:
# <user name>|*  <home path>
#
# Output on stdout for FILSYS records, whitespace separated:
# <user name>|*  AFS  <export path>  <mount options>  <mount path>
# <user name>|*  NFS  <export path>  <server>  <mount options>  <mount path>
# <user name>|*  <FS type>  <device>  <mount options>  <mount path>
#
# Return codes:
# 0 for success, anything else for error.
#
# Default value:        FSCOMMAND=  [none]
#
FSCOMMAND=



# FILSYS record generation
# ------------------------------------------------------------------------------

# The Linux automounter supports Hesiod as a provider of filesystem maps. On the
# server, this takes the form of FILSYS TXT records. The client systems must be
# configured to use the automounter for home directories.

# Generate FILSYS records?
#
# Default value:        FILSYS=0
#
FILSYS=0

# Generate automatic FILSYS records from the values of the following parameters
# (FSTYPE, NFSSERVER, FSMOUNTOPTS)?
#
# This is different from the FILSYS option above, which controls whether FILSYS
# records should be emitted at all (including FSMAPFILE, FSCOMMAND and
# FILSYSAUTO).
#
# Default value:        FILSYSAUTO=0
#
FILSYSAUTO=0

# Filesystem type or protocol to access the home directories.
#
# Traditional Hesiod supports only 2 types: AFS and NFS. Those two have special
# dedicated encodings. See the documentation text of FSMAPFILE for the list of
# required fields.
#
# The Linux automounter daemon supports other filesystem types. See the Hesutils
# documentation and autofs(5) for additional information.
#
# Default value:        FSTYPE=NFS
#
FSTYPE=NFS

# Name of the NFS server exporting the home directories.
#
# This can be an IP address or a hostname. The hostname must resolve from the
# client nodes, but not necessarily from the machine on which this script runs.
#
# This parameter is only used when FSTYPE=NFS.
#
# Default value:        NFSSERVER=$(hostname -f)  [FQDN of the local machine]
#
NFSSERVER=$(hostname -f)

# Filesystem mount options.
#
# This can be "r" (read-only) and "w" (read-write) from the traditional FILSYS
# specifications, or any modern mount option string.
#
# Default value:        FSMOUNTOPTS="rw"
#
FSMOUNTOPTS="rw"



# Hesiod output format
# ------------------------------------------------------------------------------

# Select the Hesiod TXT record output format.
#
# Possible values:      "dnsmasq"
#                       "unbound"
#                       "bind"
#
# Default values:       OUTPUTFMT="dnsmasq"
#
OUTPUTFMT="dnsmasq"



# Miscellaneous configuration options
# ------------------------------------------------------------------------------

# Prevent Hesiod lookups without a local TXT record (a.k.a. unknown users and
# groups) from being forwarded to the upstream DNS servers?
#
# This configuration option applies only to forwarding DNS servers, currently
# dnsmasq.
#
# Default value:        BLOCKUPSTREAM=1
#
BLOCKUPSTREAM=1

# The default domain name used for Hesiod queries when the client libhesiod is
# not configured, is still the original one from MIT (ns.athena.mit.edu). Any
# Hesiod lookup from unconfigured clients will thus be forwarded to the MIT DNS
# servers, if not blocked.
#
# Prevent Hesiod lookups from unconfigured clients from being forwarded to the
# hardcoded default DNS server?
#
# This configuration option applies only to forwarding DNS servers, currently
# dnsmasq.
#
# Default value:        BLOCKATHENA=1
#
BLOCKATHENA=1

